<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RGCxGC">
<title>Introduction to RGCxGC package • RGCxGC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to RGCxGC package">
<meta property="og:description" content="RGCxGC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RGCxGC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Explanation.html">Introduction to RGCxGC package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DanielQuiroz97/RGCxGC/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to RGCxGC package</h1>
                        <h4 data-toc-skip class="author">Cristian
Quiroz-Moreno</h4>
            
            <h4 data-toc-skip class="date">2022-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DanielQuiroz97/RGCxGC/blob/HEAD/vignettes/Explanation.Rmd" class="external-link"><code>vignettes/Explanation.Rmd</code></a></small>
      <div class="d-none name"><code>Explanation.Rmd</code></div>
    </div>

    
    
<style>
body {text-align: justify}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is the vignette to explain the implementation of RGCxGC package.
This text presents an end-to-end pipeline for the analysis of
comprehensive two dimensional gas chromatography (GCxGC-MS) data. You
can access a specific function help through the command
help(<em>[‘function name’]</em>).</p>
<p>A general workflow about signal preprocessing in chromatography is
summarized in Figure 1. Raw chromatographic signals usually contains
undesirable artifacts, such as chemical and instrumental noise.
Therefore, noise in the data should be removed prior statistical
analysis. Furthermore, noise can be significantly reduced by using
preprocessing algorithms, herein smoothing, baseline correction, and
peak alignment. Then, in order to reveal differences between groups,
multivariate analysis can be performed.</p>
<div class="figure" style="text-align: center">
<img src="images/dataProcessing.png" alt="Figure 1. Overview of general data processing pipeline in chromatography that is presented in the RGCxGC package." width="80%"><p class="caption">
Figure 1. Overview of general data processing pipeline in chromatography
that is presented in the RGCxGC package.
</p>
</div>
<p>In the RGCxGC package, first, the raw chromatogram is importing from
a <strong>NetCDF</strong> file and is folded into the two-dimensional
Total Intensity Chromatogram (2D-TIC). Next, you can perform three
preprocessing methodologies in order to enhance signals, such as smooth,
baseline correction, and peak alignment. Basically, smooth enhance the
signal to noise ratio (S/N), baseline correction handles column
blooding, and peak alignment corrects the retention time shift of the
peaks across multiple runs. Finally, you can perform a multiway
principal component analysis (MPCA) to look for systematic patterns that
distinguish your samples.</p>
<div class="section level3">
<h3 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h3>
<p>The basic workflow of the RGCxGC package is composed of two main
steps, preprocessing and multivariate analysis, after the data is
imported (Figure 2).</p>
<div class="figure" style="text-align: center">
<img src="images/basicWorkflow.jpg" alt="Figure 2. The basic workflow of RGCxGC package. The functions for each step are in parenthesis. The double line between smooth andbaseline correction refers to the interchangeable pathway." width="80%"><p class="caption">
Figure 2. The basic workflow of RGCxGC package. The functions for each
step are in parenthesis. The double line between smooth andbaseline
correction refers to the interchangeable pathway.
</p>
</div>
<p>The raw NetCDF file is imported with the <strong>read_chrom</strong>
function, by providing the file name and modulation time that the GCxGC
data was acquired. Next, you can perform preprocessing routines like
smoothing and/or baseline correction by using the function
<strong>wsmooth</strong> and <strong>baseline_corr</strong>,
respectively. Then, peak alignment of a single sample against a
reference chromatogram can be performed based on the two-dimensional
correlation optimized warping (2DCOW) algorithm. Alternatively, multiple
sample alignment can be performed with <strong>batch_2DCOW</strong>
function. After signal preprocessing, MPCA can be performed over the
dataset by using the <strong>m_prcomp</strong> functions. As result of
the MPCA, you can access to the score matrix through
<strong>scores</strong> function, or plot the loading matrix with the
<strong>plot_loading</strong> function. Finally, the MPCA summary can be
retrieved with the <strong>print_mpca</strong> function. On the other
hand, the RGCxGC package can export the two-dimensional chromatograms in
order to perform supervised models. It can be done through
<strong>unfold_chrom</strong>. Supervised models can be done with the <a href="https://bioconductor.org/packages/release/bioc/html/mixOmics.html" class="external-link">mixOmics</a>
functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="detailed-workflow">Detailed workflow<a class="anchor" aria-label="anchor" href="#detailed-workflow"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the package in different manners. The most common is
to install it from CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"RGCxGC"</span><span class="op">)</span></span></code></pre></div>
<p>Another way is to install it is through the developer version in
github.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"DanielQuiroz97/RGCxGC"</span><span class="op">)</span></span></code></pre></div>
<p>Once you have successfully installed the package, you can acces to
every functions and data provided by calling the library.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DanielQuiroz97/RGCxGC" class="external-link">RGCxGC</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: RNetCDF</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: ptw</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'RGCxGC'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:graphics':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     plot</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     plot</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="importing-raw-chromatogram">Importing raw chromatogram<a class="anchor" aria-label="anchor" href="#importing-raw-chromatogram"></a>
</h3>
<p>The example data is retrieved form <a href="https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0006215" class="external-link">Diagnostic
metabolite biomarkers of chronic typhoid carriage</a>. You can access to
the whole dataset with the identifier <a href="https://www.ebi.ac.uk/metabolights/MTBLS579" class="external-link">MTBLS579</a> in the
<a href="https://www.ebi.ac.uk/metabolights/" class="external-link">MetaboLights</a>
database.</p>
<p>You can import the raw chromatogram through the
<strong>read_chrom</strong> function. This function requires at least
two parameters: the name of the <em>NetCDF</em> file (name), and the
modulation time. This is an adaptation of Skov routine <span class="citation">Skov and Bro (2008)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chrom_08</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"08GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span>
<span><span class="va">MTBLS08</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">chrom_08</span>, mod_time <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in base_GCxGC(Object = Object, mod_time = mod_time, sam_rate =</span></span>
<span><span class="co">## sam_rate, : The last 51 signals will be omitted</span></span></code></pre>
<pre><code><span><span class="co">## Warning in matrix(tic, nrow = len_1d, ncol = len_2d): data length [61051] is not</span></span>
<span><span class="co">## a sub-multiple or multiple of the number of rows [500]</span></span></code></pre>
<pre><code><span><span class="co">## Retention time ranges:</span></span>
<span><span class="co">## 1D (min): 7.98 18.16 </span></span>
<span><span class="co">## 2D (sec): 0 5 </span></span>
<span><span class="co">## Acquisition rate: 100</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">slotNames</span><span class="op">(</span><span class="va">MTBLS08</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "chromatogram" "time"         "name"         "mod_time"</span></span></code></pre>
<p>As we can see, the MTBLS08 object has four slots. The first one
correspond to the 2D-TIC chromatogram. The second slot refers to the
retention time in the first dimension. The third slot is the name of the
NetCDF file, which is first check for validity before importing the
chromatogram. Finally, the fourth slot is the modulation time in the
second dimension.</p>
</div>
<div class="section level3">
<h3 id="chromatogram-visualization">Chromatogram visualization<a class="anchor" aria-label="anchor" href="#chromatogram-visualization"></a>
</h3>
<p>To visualize chromatograms, you can use the <strong>plot</strong>
function. It is built from <strong>filled.contour</strong> R base
function. Since contour plots is a good choice to display non-native
GCxGC data <span class="citation">(Reichenbach et al. 2004)</span>. The
default function only plots the most intense signals, into a few breaks.
For a detailed tutorial on 2D chromagram visualization, please visit the
<a href="https://danielquiroz97.gitlab.io/post/plotting-chromatograms/" class="external-link">tutorial
web site</a>.</p>
<p>Due to the large variety of metabolite concentrations in a sample,
the total ion current can also have large variability in the intensity
scale. Therefore, you have to set the number of levels in hundreds. As
the number of levels increases, you can obtain a more detailed
chromatogram. On the other hand, you can use color palettes presented in
the <em>colorRamps</em> package (matlab.like &amp; matlab.like2).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nlevels: Number of levels</span></span>
<span><span class="co"># color.palette: The color palette to employ</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">colorRamps</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">MTBLS08</span>, nlevels <span class="op">=</span> <span class="fl">100</span>, color.palette <span class="op">=</span> <span class="va">matlab.like2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/Chrom%20plot-1.png" width="60%"></p>
</div>
<div class="section level3">
<h3 id="signal-preprocessing">Signal preprocessing<a class="anchor" aria-label="anchor" href="#signal-preprocessing"></a>
</h3>
<p>In chromatography, the net metabolite signals are often obscured by
instrumental and chemical noise. These undesirable signals disturbs the
chemical interpretation of the results. In order to remove irrelevant
information, some preprocessing steps can be employed. The most common
preprocessing algorithms are: baseline correction, smoothing and peak
alignment, which are reviewed in the following sections.</p>
<div class="section level4">
<h4 id="baseline-correction">Baseline correction<a class="anchor" aria-label="anchor" href="#baseline-correction"></a>
</h4>
<p>Baseline correction remove a steady and increasing intensity in the
signal. For example, contamination of the instrument system injection or
column bleeding. The baseline correction implemented in this package
employs the asymmetric least squares algorithm <span class="citation">(Eilers 2004)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MTBLS08_bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_corr.html">baseline_corr</a></span><span class="op">(</span><span class="va">MTBLS08</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">MTBLS08_bc</span>, nlevels <span class="op">=</span> <span class="fl">100</span>, color.palette <span class="op">=</span> <span class="va">matlab.like2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/baseline%20correction-1.png" width="60%"></p>
<p>The result of this preprocessing step is a cleaner chromatogram. The
baseline has been removed and all of the separation space has filled
with a more intense blue.</p>
</div>
<div class="section level4">
<h4 id="smoothing">Smoothing<a class="anchor" aria-label="anchor" href="#smoothing"></a>
</h4>
<p>The Whittaker smoother algorithm<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The base functions (with1 &amp;amp; with2) are coupled from
the &lt;em&gt;ptw&lt;/em&gt; package&lt;/p&gt;"><sup>1</sup></a> is used in this package <span class="citation">(Eilers 2003)</span>. As the main advantages, it
accounts with computational efficiency, control over smoothness and
automatically interpolation. The Whittaker smoother for GCxGC is
implemented in the first chromatogram dimension. In other words,
smoothing is carry out to every chromatographic modulation.</p>
<p>The Whittaker smooth algorithm works with discrete penalized least
squares. For instance, the penalty order (1 or 2) and the <span class="math inline">\(\lambda\)</span> arguments has to be provided.
While the penalty refers to the order to penalize the roughness of the
signals, <span class="math inline">\(\lambda\)</span> is factor which
multiply the rougness signal level. For instance, greater parameter
values will hava a stronger influence in the smmothing process.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linear penalty with lambda equal to 10</span></span>
<span><span class="va">MTBLS08_sm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmooth.html">wsmooth</a></span><span class="op">(</span><span class="va">MTBLS08_bc</span>, penalty <span class="op">=</span> <span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">1e1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">MTBLS08_sm1</span>, nlevels <span class="op">=</span> <span class="fl">100</span>, color.palette <span class="op">=</span> <span class="va">matlab.like</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="st">"= 10, penalty = 1"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/smoothing-1.png" width="60%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cuadratic penalty with lambda equal to 10</span></span>
<span><span class="va">MTBLS08_sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmooth.html">wsmooth</a></span><span class="op">(</span><span class="va">MTBLS08_bc</span>, penalty <span class="op">=</span> <span class="fl">2</span>, lambda <span class="op">=</span> <span class="fl">1e1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">MTBLS08_sm2</span>, nlevels <span class="op">=</span> <span class="fl">100</span>, color.palette <span class="op">=</span> <span class="va">matlab.like</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="st">"= 10, penalty = 2"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/smoothing%202-1.png" width="60%"></p>
</div>
<div class="section level4">
<h4 id="peak-alignment">Peak alignment<a class="anchor" aria-label="anchor" href="#peak-alignment"></a>
</h4>
<p>In the chemometric pipeline, the user selects the desired and
required preprocessing steps. However, peak alignment is practically
mandatory whenever multiple samples should be compared. The peak
alignment corrects unavoidable shifts of the retention times among
chromatographic runs.</p>
<p>There are two general pathways for peak alignment: using peak table,
or pixel level alignment. In this package, the pixel level alignment is
implemented by using the two-dimensional correlation optimized warping
(2D-COW) algorithm is implemented <span class="citation">(Dabao Zhang et
al. 2008)</span>. Basically, the algorithm works by splitting the raw
chromatogram into <span class="math inline">\(n\)</span> segments. Then,
time warping is applied over each dimensions using the one dimensional
correlation optimized warping (COW) algorithm <span class="citation">(Tomasi, Van Den Berg, and Andersson 2004)</span>.</p>
<p>The <strong>TwoDCOW</strong> function need four arguments: the sample
name, the reference chromatogram, the number of segments to split the
chromatogram and the maximum warping level for both dimensions.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reference chromatogram</span></span>
<span><span class="va">chrom_09</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"09GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span>
<span><span class="va">MTBLS09</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">chrom_09</span>, mod_time <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in base_GCxGC(Object = Object, mod_time = mod_time, sam_rate =</span></span>
<span><span class="co">## sam_rate, : The last 51 signals will be omitted</span></span></code></pre>
<pre><code><span><span class="co">## Warning in matrix(tic, nrow = len_1d, ncol = len_2d): data length [61051] is not</span></span>
<span><span class="co">## a sub-multiple or multiple of the number of rows [500]</span></span></code></pre>
<pre><code><span><span class="co">## Retention time ranges:</span></span>
<span><span class="co">## 1D (min): 7.98 18.16 </span></span>
<span><span class="co">## 2D (sec): 0 5 </span></span>
<span><span class="co">## Acquisition rate: 100</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Baseline correction</span></span>
<span><span class="va">MTBL09_bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_corr.html">baseline_corr</a></span><span class="op">(</span><span class="va">MTBLS09</span><span class="op">)</span></span>
<span><span class="co"># Smoothing</span></span>
<span><span class="va">MTBL09_sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmooth.html">wsmooth</a></span><span class="op">(</span><span class="va">MTBL09_bc</span>, penalty <span class="op">=</span> <span class="fl">2</span>, lambda <span class="op">=</span> <span class="fl">1e1</span><span class="op">)</span></span>
<span><span class="co"># Alignment </span></span>
<span><span class="va">aligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/twod_cow.html">twod_cow</a></span><span class="op">(</span>sample_chrom <span class="op">=</span> <span class="va">MTBLS08_sm2</span>, ref_chrom <span class="op">=</span>  <span class="va">MTBL09_sm2</span>,</span>
<span>                   segments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, max_warp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">aligned</span>, nlevels <span class="op">=</span> <span class="fl">100</span>, color.palette <span class="op">=</span> <span class="va">matlab.like</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Aligned chromatogram"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/2DCOW-1.png" width="60%"></p>
</div>
<div class="section level4">
<h4 id="batch-peak-alignment">Batch peak alignment<a class="anchor" aria-label="anchor" href="#batch-peak-alignment"></a>
</h4>
<p>Normally, multiple samples are analyzed into batches. Therefore, to
align multiple samples simultaneosuly is a more confortable option. The
<strong>batch_2DCOW</strong> function performs this action.</p>
<p>First, you need to import the reference and sample chromatogram.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read Sample chromatogram</span></span>
<span><span class="va">GB08_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"08GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span>
<span><span class="va">MTBLS08</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">GB08_fl</span>, mod_time <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in base_GCxGC(Object = Object, mod_time = mod_time, sam_rate =</span></span>
<span><span class="co">## sam_rate, : The last 51 signals will be omitted</span></span></code></pre>
<pre><code><span><span class="co">## Warning in matrix(tic, nrow = len_1d, ncol = len_2d): data length [61051] is not</span></span>
<span><span class="co">## a sub-multiple or multiple of the number of rows [500]</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read reference chromatogram</span></span>
<span><span class="va">GB09_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"09GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span>
<span><span class="va">MTBLS09</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">GB09_fl</span>, mod_time <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in base_GCxGC(Object = Object, mod_time = mod_time, sam_rate =</span></span>
<span><span class="co">## sam_rate, : The last 51 signals will be omitted</span></span>
<span></span>
<span><span class="co">## Warning in base_GCxGC(Object = Object, mod_time = mod_time, sam_rate =</span></span>
<span><span class="co">## sam_rate, : data length [61051] is not a sub-multiple or multiple of the number</span></span>
<span><span class="co">## of rows [500]</span></span></code></pre>
<p>The batch function needs a <strong>named list</strong> of sample
chromatograms that will be aligned. Just for demonstration GB08
chromatogram will be triplicated to simulate multiple samples.</p>
<p><strong>Note:</strong> List names will be considered as the names of
each chromatograms and the object name will be omitted.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">batch_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Chrom1 <span class="op">=</span> <span class="va">MTBLS08</span>, Chrom2 <span class="op">=</span> <span class="va">MTBLS08</span>, Chrom3 <span class="op">=</span> <span class="va">MTBLS08</span><span class="op">)</span></span></code></pre></div>
<p>Then, you must to introduce the same parameters explained above
(segments and maximum warping).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">batch_alignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_2DCOW.html">batch_2DCOW</a></span><span class="op">(</span><span class="va">MTBLS09</span>, <span class="va">batch_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">batch_alignment</span><span class="op">@</span><span class="va">Batch_2DCOW</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Chrom1" "Chrom2" "Chrom3"</span></span></code></pre>
<p>As you can see, the names of the sample chromatograms are the names
of its object the list. In this batch example, the reference
chromatogram is included as another sample chromatogram. This is useful
when a representative chromatogram is selected as a reference.
Therefore, it should be added after sample chromatograms are aligned. On
the other hand, there is an option that allows to make an average
chromatogram of multiple chromatograms. Therefore, if you batch align
sample cromatograms against the new chromatogram, it should not be added
as a sample chromatogram. In this cases, you should set the argument
<em>add_ref = FALSE</em>.</p>
</div>
<div class="section level4">
<h4 id="get-all-chromatograms-together">Get all chromatograms together<a class="anchor" aria-label="anchor" href="#get-all-chromatograms-together"></a>
</h4>
<p>Once the chromatograms are already preprocessed, it has to be in a
single R object. To meet this requirement, the
<strong>join_chromatograms</strong> functions does it. Additionally, if
you have the metadata, you can also join into this R object. By default,
the MPCA is carried out with mean centered and unit scaled data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allChrom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_chromatograms.html">join_chromatograms</a></span><span class="op">(</span><span class="va">MTBLS09</span>, <span class="va">MTBLS08</span><span class="op">)</span></span></code></pre></div>
<p>In this function, you can provide as many chromatograms or batch
chromatograms as you want. What only issue you have to take into
consideration is, if you provide a single chromatogram, you have to call
the function with a named argument. For example, if you have a
chromatogram of name chrom_control, you have to call the function trough
<em>(chrom_control = chrom_control)</em>.</p>
<p>For example, lets consider that we have the following objects:</p>
<ul>
<li>
<strong>reference_1:</strong> A single reference chromatogram of
group one,</li>
<li>
<strong>reference_2:</strong> A single reference chromatogram of
group two,</li>
<li>
<strong>batch_samp1:</strong> A batch aligned chromatograms of the
group one,</li>
<li>
<strong>batch_samp2:</strong> A batch aligned chromatograms of the
group two and</li>
<li>
<strong>metadata_exp</strong> The experiment metadata.</li>
</ul>
<p>Then, the user should proceed as follow:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_chromatograms.html">join_chromatograms</a></span><span class="op">(</span><span class="va">batch_samp1</span>, <span class="va">batch_samp2</span>,<span class="co">#Two batch samples</span></span>
<span>                                   Ref_chrom1 <span class="op">=</span> <span class="va">reference_1</span>,<span class="co">#User named argument</span></span>
<span>                                   Ref_chrom2 <span class="op">=</span> <span class="va">reference_2</span>,<span class="co">#User named argument</span></span>
<span>                                   groups <span class="op">=</span> <span class="va">metadata_exp</span><span class="op">)</span>   <span class="co">#Metadata</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="multiway-principal-component-analysis">Multiway Principal Component Analysis<a class="anchor" aria-label="anchor" href="#multiway-principal-component-analysis"></a>
</h3>
<p>Multivariate analysis is chosen in the RGCxGC package in order to
extract the main variables that distinguish the samples. Due to high
complexity of the chromatograms containing thousands of variables, the
multivariate algorithms is an interesting approach for data analysis in
GCxGC.</p>
<p>In this case, the extension of principal component analysis is
implemented, the Multiway Principal Component Analysis (MPCA) <span class="citation">(Wold et al. 1987)</span>. It can handle the three
dimensions of the dataset that is typical for 2D-TIC from GCxGC.</p>
<p>The example data has two groups, the <em>S. typhy</em> carriage, and
the control group. In this sense we are going to perform MPCA with 6
chromatograms.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Names</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">08GB</td>
<td align="left">S. typhy Carriege</td>
</tr>
<tr class="even">
<td align="left">09GB</td>
<td align="left">S. typhy Carriege</td>
</tr>
<tr class="odd">
<td align="left">14GB</td>
<td align="left">S. typhy Carriege</td>
</tr>
<tr class="even">
<td align="left">29GB</td>
<td align="left">Control</td>
</tr>
<tr class="odd">
<td align="left">34GB</td>
<td align="left">Control</td>
</tr>
<tr class="even">
<td align="left">24GB</td>
<td align="left">Control</td>
</tr>
</tbody>
</table>
<p>In the previous section, the <em>S. typhy</em> carriage is already
aligned. In order to have the same preprocessing techniques for both
groups, the control chromatograms will be aligned. The chromatogram set
can be called with the name of <strong>MTBLS579</strong> name.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MTBLS579</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: If you would like to work with the whole
chromatograms, dowload the <em>MTBLS.rda</em> file from this <a href="https://github.com/DanielQuiroz97/MTBLS579" class="external-link">link</a>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_MPCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m_prcomp.html">m_prcomp</a></span><span class="op">(</span><span class="va">MTBLS579</span>, center <span class="op">=</span> <span class="cn">T</span>, scale <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="scores">Scores<a class="anchor" aria-label="anchor" href="#scores"></a>
</h4>
<p>The scores is the projection in the reduced multivariate space
spanned by principal components, and it is related to the
(chromatographic) differences among the samples. To access to the scores
matrix, you can use the <strong>scores</strong> function.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scores-methods.html">scores</a></span><span class="op">(</span><span class="va">exp_MPCA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Names        PC1       PC2        PC3           PC4           PC5</span></span>
<span><span class="co">## 1  08GB -2508140.9 -937066.4   40646.55 -2.224940e-08 -2.943485e-09</span></span>
<span><span class="co">## 2  09GB -2508140.9 -937066.4   40646.55 -2.224940e-08 -2.943485e-09</span></span>
<span><span class="co">## 3  14GB -1784822.7 1558957.2 -749416.56 -1.439727e-08 -1.505606e-09</span></span>
<span><span class="co">## 4  24GB   277512.5  987227.1 1110137.04  3.789541e-09 -5.898144e-10</span></span>
<span><span class="co">## 5  29GB  3261796.0 -336025.7 -221006.79  2.698099e-08  3.918622e-09</span></span>
<span><span class="co">## 6  34GB  3261796.0 -336025.7 -221006.79  2.698099e-08  3.918622e-09</span></span>
<span><span class="co">##             PC6              Type</span></span>
<span><span class="co">## 1 -6.283813e-09 S. typhy Carriege</span></span>
<span><span class="co">## 2 -6.283813e-09 S. typhy Carriege</span></span>
<span><span class="co">## 3 -3.743423e-09 S. typhy Carriege</span></span>
<span><span class="co">## 4  3.026344e-10           Control</span></span>
<span><span class="co">## 5  9.563252e-09           Control</span></span>
<span><span class="co">## 6  9.563252e-09           Control</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="loadings">Loadings<a class="anchor" aria-label="anchor" href="#loadings"></a>
</h4>
<p>While the scores matrix represents the relationship between samples,
the loading matrix explain the relationship between variables. To plot
loadings, you can use the <strong>plot_loading</strong> function. The
<em>type</em> argument refers to positive (type = “p”) or negative (type
= “n”) loading values or (type = “b”) for both loadings values. The
default option of this function is to plot the first principal
component, even though, you can choose setting the <em>pc</em>
argument.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Negative loadings</span></span>
<span><span class="fu"><a href="../reference/plot_loading-methods.html">plot_loading</a></span><span class="op">(</span><span class="va">exp_MPCA</span>, type <span class="op">=</span> <span class="st">"n"</span>, main <span class="op">=</span> <span class="st">"Negative loadings"</span>,</span>
<span>             color.palette <span class="op">=</span> <span class="va">matlab.like</span><span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/negative%20loadings-1.png" width="60%"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Positive loadings</span></span>
<span><span class="fu"><a href="../reference/plot_loading-methods.html">plot_loading</a></span><span class="op">(</span><span class="va">exp_MPCA</span>, type <span class="op">=</span> <span class="st">"p"</span>, main <span class="op">=</span> <span class="st">"Positive loadings"</span>,</span>
<span>             color.palette <span class="op">=</span> <span class="va">matlab.like</span><span class="op">)</span></span></code></pre></div>
<p><img src="Explanation_files/figure-html/positive%20loadings-1.png" width="60%"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-DabaoZhang2008" class="csl-entry">
Dabao Zhang, Xiaodong Huang, Fred E. Regnier, and Min Zhang. 2008.
<span>“<span class="nocase">Two-dimensional correlation optimized
warping algorithm for aligning GCxGC-MS data</span>.”</span>
<em>Analytical Chemistry</em> 80 (8): 2664–71.
</div>
<div id="ref-Eilers2003" class="csl-entry">
Eilers, Paul H. C. 2003. <span>“<span class="nocase">A perfect
smoother</span>.”</span> <em>Analytical Chemistry</em> 75 (14): 3631–36.
</div>
<div id="ref-Eilers2004" class="csl-entry">
———. 2004. <span>“<span>Parametric Time Warping</span>.”</span>
<em>Analytical Chemistry</em> 76 (2): 404–11.
</div>
<div id="ref-Reichenbach2004" class="csl-entry">
Reichenbach, Stephen E., Mingtian Ni, Visweswara Kottapalli, and Arvind
Visvanathan. 2004. <span>“<span class="nocase">Information technologies
for comprehensive two-dimensional gas chromatography</span>.”</span>
<em>Chemometrics and Intelligent Laboratory Systems</em> 71 (2): 107–20.
</div>
<div id="ref-Skov2008" class="csl-entry">
Skov, Thomas, and Rasmus Bro. 2008. <span>“<span class="nocase">Solving
fundamental problems in chromatographic analysis</span>.”</span>
<em>Analytical and Bioanalytical Chemistry</em> 390 (1): 281–85.
</div>
<div id="ref-Tomasi2004" class="csl-entry">
Tomasi, Giorgio, Frans Van Den Berg, and Claus Andersson. 2004.
<span>“<span class="nocase">Correlation optimized warping and dynamic
time warping as preprocessing methods for chromatographic
data</span>.”</span> <em>Journal of Chemometrics</em> 18 (5): 231–41.
</div>
<div id="ref-Wold1987" class="csl-entry">
Wold, Svante, Paul Geladi, Kim Esbensen, and Jerker Öhman. 1987.
<span>“<span class="nocase">Multi-way principal components- and
PLS-analysis</span>.”</span> <em>Journal of Chemometrics</em> 1 (January
1986): 41–56.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cristian Quiroz-Moreno, Guilherme L. Alexandrino, Noroska G.S. Mogollón.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
