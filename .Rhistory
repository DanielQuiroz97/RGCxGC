meta = water_metadata, st_dv = 1.75,
y_adj = 1, x_adj = 1)
water_nmpsPLT$Specie
water_nmpsPLT$Envir
water_nmpsPLT <- nmds_plot(ob_nmds = water_nmds, ef = water_ef,
meta = water_metadata, st_dv = 2,
y_adj = 1, x_adj = 1)
water_nmpsPLT$Specie
water_nmpsPLT$Envir
water_nmpsPLT <- nmds_plot(ob_nmds = water_nmds, ef = water_ef,
meta = water_metadata, st_dv = 2.5,
y_adj = 1, x_adj = 1)
water_nmpsPLT$Specie
water_nmpsPLT$Envir
soil_mt_heat <- communi_matrix(dat = soil, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_soil)
heatmap_cluster(soil_mt_heat, thresh = 13)
annot_df <- data.frame(Altitude = factor(soil_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
hm_soil <- heatmap_cluster(soil_mt_heat, thresh = 13,# top_annotation = ha,
km = 2, column_title = "Soil Samples")
hm_soil
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 20, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 25, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 22, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 21, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 26, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
# Create the community matrix
water_mt_heat <- communi_matrix(dat = water, OTU_level = "Order",
rt = 2, Field = "Hits", rw_names = rw_water)
# Create the heatmap annotation
annot_df <- data.frame(Altitude = factor(water_metadata$Altitude))
col <- list(Altitude = c("Low" = "blue", "High" = 'red'))
ha <- HeatmapAnnotation(df = annot_df, col = col)
# Display the heatmap
hm_water <- heatmap_cluster(water_mt_heat, thresh = 27, #top_annotation = ha,
km = 2, column_title = "Water Samples")
hm_water
plot_krona(ps ,"CAY-krona","Type")
save.image("~/Bacteria_Ark/CAYAMBE/.RData")
plot_krona(ps ,"CAY-krona","Type")
save(ps, file = "phyloseq.RData")
plot_krona(ps ,"CAY-krona","Type")
plot_krona(ps ,"CAY-krona","Sample")
plot_krona(ps ,"Krona-Type","Type")
plot_krona(ps ,"Krona-Sample","Sample")
31-17
setClass("A", slots = c(a = "abc"))
setClass("A", slots = c(a = "matrix"))
new("A")
setClass("B", contains = "A")
new("B")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
data(MTBLS579)
MTBLS579_mpca <- m_prcomp(MTBLS579)
print(MTBLS579_mpca)
scores(MTBLS579_mpca)
plot_loading(MTBLS579_mpca)
MTBLS579_mpca@mod_time
MTBLS579@mod_time
MTBLS579@mod_time <- c(0, 5)
plot_loading(MTBLS579_mpca)
MTBLS579_mpca <- m_prcomp(MTBLS579)
plot_loading(MTBLS579_mpca)
class(MTBLS579_mpca)
is(MTBLS579_mpca, "projected")
devtools::load_all(".")
plot_loading(MTBLS579_mpca)
new
("MPCA")
new("MPCA")
new("MPCA", mod_time = 5)
devtools::load_all(".")
load("~/Daniel/Fabio Augusto/PLSDA.RData")
# Add needed libraries
library(tidyverse) # Easily Install and Load the 'Tidyverse'
library(RGCxGC) # GCxGC chemometrics
library(colorRamps) # Builds color tables
library(ggsci) # Scientific Journal and Sci-Fi Themed Color Palettes for
library(mixOmics) # PLS-DA omics
# Add needed libraries
library(tidyverse) # Easily Install and Load the 'Tidyverse'
library(RGCxGC) # GCxGC chemometrics
library(colorRamps) # Builds color tables
library(ggsci) # Scientific Journal and Sci-Fi Themed Color Palettes for
library(mixOmics) # PLS-DA omics
#### Mix Omics ####
list_chrom <- unfold_chrom(all_chrom)
unfolded_chrom <- list_chrom$chromatogram
colnames(unfolded_chrom) <- paste0("RT", seq(dim(unfolded_chrom)[2]))
Index_chrom <- tibble(Names = rownames(unfolded_chrom))
all_index <- left_join(Index_chrom, metadata, by = "Names") %>%
mutate(Index =  seq(n()), Activity = factor(Activity) )
Y <- all_index$Activity
set.seed(10)
srbct_plsda <- plsda(unfolded_chrom, Y, ncomp = 2)
background <- background.predict(srbct_plsda, comp.predicted=2,
dist = "max.dist")
plotIndiv(srbct_plsda, comp = 1:2,
group = Y, ind.names = FALSE,
legend = TRUE,  background = background)
chrom_dim <- ncol(unfolded_chrom)
test.keepX <- list.keepX <- seq(chrom_dim/3, chrom_dim, 6000)
perf_plsda <- perf(srbct_plsda, validation = "Mfold", folds = 5,
progressBar = T, auc = T, nrepeat = 10, cpus = 12)
tune_plsda <- tune.splsda(unfolded_chrom, Y, ncomp = 2, validation = 'Mfold', folds = 5,
progressBar = T, dist = 'max.dist',cpus = 12,
test.keepX = list.keepX, nrepeat = 10)
tune_plsda$choice.ncomp$ncomp
ncom <- tune_plsda$choice.ncomp$ncomp +1
tune_plsda$choice.keepX
ncol(unfolded_chrom)
final_splsda <- splsda(unfolded_chrom, Y, ncomp = 2)
final_splsda2 <- splsda(unfolded_chrom, Y, ncomp = 2, keepX = test_keepX)
test_keepX <- tune_plsda$choice.keepX
final_splsda2 <- splsda(unfolded_chrom, Y, ncomp = 2, keepX = test_keepX)
# Loadings 1PC
lds <- final_splsda2$loadings$X
ld1 <- lds[, 1]
LD1 <- t(matrix(ld1, nrow = 150, ncol = 368, byrow = T))
#plot(LD1,type = "c")
filled.contour(LD1, color.palette = colfunc, nlevels = 50)
colfunc <- colorRampPalette(c("red", "yellow", "springgreen", "royalblue"))
#plot(LD1,type = "c")
filled.contour(LD1, color.palette = colfunc, nlevels = 50)
LD1[LD1 >  -0.0075] <- 0
#plot(LD1,type = "c")
filled.contour(LD1, color.palette = colfunc, nlevels = 50)
# Loadings 2PC
lds <- final_splsda2$loadings$X
ld2 <- lds[, 2]
LD2 <- t(matrix(ld1, nrow = 150, ncol = 368, byrow = T))
LD2[LD2 >  -0.015] <- 0
#plot(LD1,type = "c")
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
# Loadings 2PC
lds <- final_splsda2$loadings$X
ld2 <- lds[, 2]
LD2 <- t(matrix(ld1, nrow = 150, ncol = 368, byrow = T))
#plot(LD1,type = "c")
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
LD2[LD2 >  -0.005] <- 0
#plot(LD1,type = "c")
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
LD2[LD2 >  -0.0075] <- 0
#plot(LD1,type = "c")
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
LD2[LD2 >  -0.008] <- 0
#plot(LD1,type = "c")
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
jpeg(paste0('./results/FAugusto_plsda_lds.jpg'), width = 6, height = 4,
units = 'in', res = 600)
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
dev.off()
setwd("~/Daniel/Fabio Augusto")
jpeg(paste0('./results/FAugusto_plsda_lds.jpg'), width = 6, height = 4,
units = 'in', res = 600)
filled.contour(LD2, color.palette = colfunc, nlevels = 50)
dev.off()
final_splsda2$X
final_splsda2$variates
# Scores
metadata <- read_csv("activity.csv")
metadata %>% merge(m_scores)
final_splsda2$variates$X
final_splsda2$variates$X %>% merge(metadata)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata)
View(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata) %>%
filter(Repetition == 1)
View(plsda_scores)
View(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata) %>%
filter(Repetition == 1)
View(plsda_scores)
glimpse(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata) %>%
distinct(Names)
View(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata) %>%
distinct(Names, .keep_all = T)
View(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% merge(metadata)
plsda_scores <- final_splsda2$variates$X %>% as.data.frame()
View(plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
merge(metadata)
plsda_scores <- final_splsda2$variates$X %>% as.data.frame()
View(plsda_scores)
metadata
# Scores
metadata <- read_csv("activity.csv")
plsda_scores <- final_splsda2$variates$X %>% as.data.frame()
left_join(metadata, plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.))
left_join(metadata, plsda_scores)
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.)) %>% left_join(metadata)
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw()
plotIndiv(final_splsda2)
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)")
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") + geom_vline(xintercept = 0)
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue")
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
grepel::geom_text_repel(data = filter(m_scores, grepl("pe2", Names)),
aes(label = Names), force = 5, xlim = c(-100, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(m_scores, grepl("pe2", Names)),
aes(label = Names), force = 5, xlim = c(-100, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, grepl("pe2", Names)),
aes(label = Names), force = 5, xlim = c(-100, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(-80, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 5, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(-80, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(-80, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(50, NA))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 50))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) + theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
#geom_point(size = 3, alpha = 0.8) +
geom_jitter(position = position_jitter(width = 0.1, height = 0.1)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
#geom_point(size = 3, alpha = 0.8) +
geom_jitter(position = position_jitter(width = 3, height = 3)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
#geom_point(size = 3, alpha = 0.8) +
geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores, aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = pca_scores,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scores <-  ggplot(plsda_scores,
aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scores,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scores <-  ggplot(plsda_scores,
aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
scale_color_aaas() +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scores,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
ggplot(plsda_scores,
aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
scale_color_aaas() +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores,
aes(comp1, comp2, color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
scale_color_aaas()+
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8)
# Scores
metadata <- read_csv("activity.csv")
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.)) %>% left_join(metadata)
plsda_scores <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() +
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
# Scores
metadata <- read_csv("activity.csv")
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.)) %>% left_join(metadata)
ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
# Scores
metadata <- read_csv("activity.csv") %>% mutate(Activity = factor(Activity))
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.)) %>% left_join(metadata)
ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
# Scores
metadata <- read_csv("activity.csv") %>%
mutate(Activity = factor(Activity, levels = c("Low", 'High') ))
plsda_scores <- final_splsda2$variates$X %>% as.data.frame() %>%
mutate(Names = rownames(.)) %>% left_join(metadata)
ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
plsda_scr <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scr,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scr <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80),
ylim = c(-50, 50))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scr,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scr <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80),
ylim = c(-100, 75))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scr,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scr <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(NA, 80),
ylim = c(-100, 75))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scr,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
plsda_scr <-  ggplot(plsda_scores, aes(comp1, comp2,
color = Activity, shape = Strain)) +
geom_point(size = 3, alpha = 0.8) +
#geom_jitter(position = position_jitter(width = 30, height = 30)) +
theme_bw() + scale_color_aaas()+
labs(x = "LV1 (34%)", y = "LV2 (10%)") +
geom_vline(xintercept = 0, col = "skyblue") +
ggrepel::geom_text_repel(data = filter(plsda_scores, Activity %in% "Low"),
aes(label = Names), force = 5, xlim = c(50, 80),
ylim = c(-100, 75))
ggsave(filename = "FAugusto_plsda_scores.jpg", plot = plsda_scr,
path = "./results", width = 6, height = 4, units = "in", dpi = 600)
