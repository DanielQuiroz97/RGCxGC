<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="`batch_2DCOW` perform two-dimensional correlation optimized warping
alignment in batch."><title>Two-dimensional COW in batch. — batch_2DCOW • RGCxGC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-dimensional COW in batch. — batch_2DCOW"><meta property="og:description" content="`batch_2DCOW` perform two-dimensional correlation optimized warping
alignment in batch."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QY8Y925P0N"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QY8Y925P0N');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RGCxGC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Explanation.html">Introduction to RGCxGC package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DanielQuiroz97/RGCxGC" aria-label="Github">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/cristianquirozd" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/danielquirozmoreno/" aria-label="Linkedin">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Two-dimensional COW in batch.</h1>
      <small class="dont-index">Source: <a href="https://github.com/DanielQuiroz97/RGCxGC/blob/HEAD/R/batchTwoDCOW.R" class="external-link"><code>R/batchTwoDCOW.R</code></a></small>
      <div class="d-none name"><code>batch_2DCOW.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`batch_2DCOW` perform two-dimensional correlation optimized warping
alignment in batch.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">batch_2DCOW</span><span class="op">(</span><span class="va">reference</span>, <span class="va">sample_chroms</span>, <span class="va">segments</span>, <span class="va">max_warp</span>, add_ref <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>reference</dt>
<dd><p>a GCxGC chromatogram which will be taken as the reference 
chromatogram.</p></dd>


<dt>sample_chroms</dt>
<dd><p>a named list with the sample chromatograms which will
be aligned against to the reference chromatogram.</p></dd>


<dt>segments</dt>
<dd><p>a two integer vector with the number of segments
which the first and second dimension will be divided, respectively.</p></dd>


<dt>max_warp</dt>
<dd><p>a two integer vector with the maximum warping parameter for
the first and second dimension</p></dd>


<dt>add_ref</dt>
<dd><p>a logical indicating if the reference chromatogram will
be joined together with the sample chromatograms. By the fault add_ref = F.
If add_ref is set to T, the provide reference chromatogram will 
be included as another sample chromatogram in the downstream analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The first argument is the reference chromatogram which other chromatograms
will aligned against to. Then, a named list is needed for the sample_chroms
argument. Each chromatogram in this list will be aligned using the reference
chromatogram. By default, the reference chromatogram will be not included in
the subsequent analysis, such as MPCA. If you would like to add the reference
chromatogram, then add_ref = T.</p>
<p>This is an adaptation of two-dimensional COW alignment, firstly implemented
in MATLAB. This function takes a set of samples chromatogram to be aligned 
against to the reference. The argument [segment] will be used 
to split the whole chromatogram in <em>n</em> and <em>m</em> parts in the first
and the second dimension, respectively. The [max_warp] argument provides
the maximum tolerance of the signal transformation for the first and the
second dimension, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Read Sample chromatogram</span></span></span>
<span class="r-in"><span><span class="va">GB08_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"08GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MTBLS08</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">GB08_fl</span>, mod_time <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The last 51 signals will be omitted</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data length [61051] is not a sub-multiple or multiple of the number of rows [500]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Retention time ranges:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1D (min): 7.98 18.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2D (sec): 0 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acquisition rate: 100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read reference chromatogram</span></span></span>
<span class="r-in"><span><span class="va">GB09_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"09GB.cdf"</span>, package <span class="op">=</span> <span class="st">"RGCxGC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MTBLS09</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_chrom.html">read_chrom</a></span><span class="op">(</span><span class="va">GB09_fl</span>, mod_time <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The last 51 signals will be omitted</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data length [61051] is not a sub-multiple or multiple of the number of rows [500]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Retention time ranges:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1D (min): 7.98 18.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2D (sec): 0 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Acquisition rate: 100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a named list</span></span></span>
<span class="r-in"><span><span class="co"># MTBLS08 will be repeated for exemplification</span></span></span>
<span class="r-in"><span><span class="co"># Considerer that chromatograms are renamed considering the list names</span></span></span>
<span class="r-in"><span><span class="va">batch_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Chrom1 <span class="op">=</span> <span class="va">MTBLS08</span>, Chrom2 <span class="op">=</span> <span class="va">MTBLS08</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform batch 2DCOW alignment</span></span></span>
<span class="r-in"><span><span class="co"># Add the reference chromatogram as another sample</span></span></span>
<span class="r-in"><span><span class="va">batch_alignment</span> <span class="op">&lt;-</span> <span class="fu">batch_2DCOW</span><span class="op">(</span><span class="va">MTBLS09</span>, <span class="va">batch_samples</span>,</span></span>
<span class="r-in"><span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, add_ref <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Exclude the reference chromatogram in the sample chromatogram set</span></span></span>
<span class="r-in"><span><span class="va">batch_alignment</span> <span class="op">&lt;-</span> <span class="fu">batch_2DCOW</span><span class="op">(</span><span class="va">MTBLS09</span>, <span class="va">batch_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Cristian Quiroz-Moreno, Guilherme L. Alexandrino, Noroska G.S. Mogollón.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

